import{_ as t,c as a,a as e,b as i,o as n}from"./app-RmE5kr10.js";const l={};function h(r,s){return n(),a("div",null,s[0]||(s[0]=[e(`<h2 id="ðŸ“˜-overview" tabindex="-1"><a class="header-anchor" href="#ðŸ“˜-overview"><span>ðŸ“˜ Overview</span></a></h2><p><code>QA_Merger</code> is a post-processing operator designed to merge questions and answers. It typically receives two separate outputs from the <code>LLMOutputParser</code> (one list of extracted questions and one list of extracted answers) and matches them into complete <strong>QA Pairs</strong> based on chapter titles and question indices.</p><h3 id="key-features" tabindex="-1"><a class="header-anchor" href="#key-features"><span>Key Features:</span></a></h3><ul><li><strong>Bi-directional Merging</strong>: Combines questions, answers, solutions, and labels using logic based on chapter titles or indices.</li><li><strong>Format Conversion</strong>: Automatically converts the merged <code>.jsonl</code> data into a human-readable <code>.md</code> (Markdown) format.</li><li><strong>Data Flattening (Explode)</strong>: Transforms the DataFrame rows from a per-file organization to a per-QA pair organization. While one file originally occupied one row, after execution, each QA pair occupies its own row, facilitating fine-grained downstream processing.</li></ul><h2 id="init-function" tabindex="-1"><a class="header-anchor" href="#init-function"><span><code>__init__</code> Function</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> output_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> strict_title_match</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> bool</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> False</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="initialization-parameters" tabindex="-1"><a class="header-anchor" href="#initialization-parameters"><span>Initialization Parameters</span></a></h3><table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><strong>output_dir</strong></td><td>str</td><td>Required</td><td>The root directory for the merged output files.</td></tr><tr><td><strong>strict_title_match</strong></td><td>bool</td><td>False</td><td>Whether to enable strict title matching. If <code>True</code>, chapter titles must match exactly. If <code>False</code>, it attempts to extract <strong>Chinese/English indices</strong> from the titles before matching.</td></tr></tbody></table><h2 id="run-function" tabindex="-1"><a class="header-anchor" href="#run-function"><span><code>run</code> Function</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DataFlowStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_question_qalist_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_answer_qalist_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_name_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        output_merged_qalist_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        output_merged_md_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        output_qa_item_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">qa_item</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Executes the merging logic: Reads the question and answer JSONL files, invokes internal utility functions to merge them, and updates the storage.</p><h4 id="parameter-descriptions" tabindex="-1"><a class="header-anchor" href="#parameter-descriptions"><span>Parameter Descriptions</span></a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><strong>storage</strong></td><td>DataFlowStorage</td><td>Required</td><td>DataFlow storage instance.</td></tr><tr><td><strong>input_question_qalist_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the question JSONL file path.</td></tr><tr><td><strong>input_answer_qalist_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the answer JSONL file path.</td></tr><tr><td><strong>input_name_key</strong></td><td>str</td><td>Required</td><td>Column name for the task name, used to create output subdirectories.</td></tr><tr><td><strong>output_merged_qalist_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the merged JSONL file path.</td></tr><tr><td><strong>output_merged_md_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the merged Markdown file path.</td></tr><tr><td><strong>output_qa_item_key</strong></td><td>str</td><td>&quot;qa_item&quot;</td><td><strong>Key Parameter</strong>: Column name for the exploded QA content. Each row will contain a dictionary of a specific QA pair.</td></tr></tbody></table><h2 id="ðŸ§ -core-logic-data-explosion-explode" tabindex="-1"><a class="header-anchor" href="#ðŸ§ -core-logic-data-explosion-explode"><span>ðŸ§  Core Logic: Data Explosion (Explode)</span></a></h2><p>Unlike most operators, <code>QA_Merger</code> changes the number of rows in the DataFrame.</p><ol><li><strong>Merge Files</strong>: It first generates a <code>merged_qa_pairs.jsonl</code> on disk, containing all QA pairs for that document.</li><li><strong>Store Objects</strong>: These QA pairs are loaded into the <code>output_qa_item_key</code> column as a <code>list</code>.</li><li><strong>Execute Explode</strong>: The operator calls <code>dataframe.explode()</code>.</li></ol><ul><li><strong>Before</strong>: 2 rows (corresponding to 2 PDF files containing 10 and 5 QA pairs respectively).</li><li><strong>After</strong>: 15 rows (each row corresponds to 1 specific QA pair; metadata in other columns like <code>input_name</code> is automatically duplicated).</li></ul><h2 id="ðŸ§ -example-results" tabindex="-1"><a class="header-anchor" href="#ðŸ§ -example-results"><span>ðŸ§  Example Results</span></a></h2><h4 id="ðŸ§¾-markdown-output-example-merged-qa-pairs-md" tabindex="-1"><a class="header-anchor" href="#ðŸ§¾-markdown-output-example-merged-qa-pairs-md"><span>ðŸ§¾ Markdown Output Example (<code>merged_qa_pairs.md</code>)</span></a></h4><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-markdown"><span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">#</span><span style="--shiki-light:#1C6B48;--shiki-light-font-weight:bold;--shiki-dark:#4D9375;--shiki-dark-font-weight:bold;"> Chapter: Chapter 1 Introduction</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-light-font-weight:bold;--shiki-dark:#DBD7CAEE;--shiki-dark-font-weight:bold;">Question 1</span><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">: What is a DataFlow system?</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-light-font-weight:bold;--shiki-dark:#DBD7CAEE;--shiki-dark-font-weight:bold;">Answer</span><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">: A type of...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-light-font-weight:bold;--shiki-dark:#DBD7CAEE;--shiki-dark-font-weight:bold;">Solution</span><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">: A DataFlow system is a...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-light-font-weight:bold;--shiki-dark:#DBD7CAEE;--shiki-dark-font-weight:bold;">Label</span><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">: 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1C6B48;--shiki-light-font-weight:bold;--shiki-dark:#4D9375;--shiki-dark-font-weight:bold;">---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-light-font-weight:bold;--shiki-dark:#DBD7CAEE;--shiki-dark-font-weight:bold;">Question 2</span><span style="--shiki-light:#999999;--shiki-light-font-weight:bold;--shiki-dark:#666666;--shiki-dark-font-weight:bold;">**</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">: </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">image</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">](</span><span style="--shiki-light:#393A3490;--shiki-light-text-decoration:underline;--shiki-dark:#DEDCD590;--shiki-dark-text-decoration:underline;">images/fig2.png</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> Please describe this image.</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ðŸ§¾-exploded-dataframe-example" tabindex="-1"><a class="header-anchor" href="#ðŸ§¾-exploded-dataframe-example"><span>ðŸ§¾ Exploded DataFrame Example</span></a></h4>`,21),i("table",null,[i("thead",null,[i("tr",null,[i("th",null,"index"),i("th",null,"name"),i("th",null,"qa_item (Column)")])]),i("tbody",null,[i("tr",null,[i("td",null,"0"),i("td",null,"task_01"),i("td",{"question:":"","Q1...,":"","answer:":"","A1...,":"","css-module":"."})]),i("tr",null,[i("td",null,"1"),i("td",null,"task_01"),i("td",{"question:":"","Q2...,":"","answer:":"","A2...,":"","css-module":"."})]),i("tr",null,[i("td",null,"2"),i("td",null,"task_02"),i("td",{"question:":"","Q1...,":"","answer:":"","A1...,":"","css-module":"."})])])],-1)]))}const o=t(l,[["render",h]]),p=JSON.parse('{"path":"/en/api/operators/pdf2vqa/generate/qamerger/","title":"QA_Merger","lang":"en-US","frontmatter":{"title":"QA_Merger","createTime":"2026/01/20 20:25:00","permalink":"/en/api/operators/pdf2vqa/generate/qamerger/"},"readingTime":{"minutes":1.61,"words":484},"git":{"createdTime":1769148661000,"updatedTime":1772028428000,"contributors":[{"name":"fatty-belly","username":"fatty-belly","email":"134311924+fatty-belly@users.noreply.github.com","commits":2,"avatar":"https://avatars.githubusercontent.com/fatty-belly?v=4","url":"https://github.com/fatty-belly"}]},"filePathRelative":"en/notes/api/operators/pdf2vqa/generate/QAMerger.md","headers":[]}');export{o as comp,p as data};
