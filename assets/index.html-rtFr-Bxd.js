import{_ as i,c as t,a,o as e}from"./app-RmE5kr10.js";const n={};function l(r,s){return e(),t("div",null,s[0]||(s[0]=[a(`<h2 id="ðŸ“˜-overview" tabindex="-1"><a class="header-anchor" href="#ðŸ“˜-overview"><span>ðŸ“˜ Overview</span></a></h2><p><code>LLMOutputParser</code> is a structured data parsing operator designed specifically to parse response text generated by Large Language Models (LLMs) that contain specific XML tags.</p><p>The core functionalities of this operator include:</p><ol><li><strong>Tag Parsing</strong>: Identifying and extracting content within tags such as <code>&lt;chapter&gt;</code>, <code>&lt;qa_pair&gt;</code>, <code>&lt;question&gt;</code>, <code>&lt;answer&gt;</code>, <code>&lt;solution&gt;</code>, and <code>&lt;label&gt;</code>.</li><li><strong>ID Restoration</strong>: Mapping numerical IDs returned by the LLM back to original text content or image tags (based on the converted layout files generated by <code>MinerU2LLMInputOperator</code>).</li><li><strong>Resource Synchronization</strong>: Automatically copying associated images from the intermediate directory to the final output directory and correcting the image reference paths.</li></ol><h2 id="init-function" tabindex="-1"><a class="header-anchor" href="#init-function"><span><code>__init__</code> Function</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> __init__</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">  </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">             output_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">             intermediate_dir</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">intermediate</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">             )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="initialization-parameters" tabindex="-1"><a class="header-anchor" href="#initialization-parameters"><span>Initialization Parameters</span></a></h3><table><thead><tr><th>Parameter</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><strong>output_dir</strong></td><td>str</td><td>Required</td><td>The final root directory for structured data and images.</td></tr><tr><td><strong>intermediate_dir</strong></td><td>str</td><td>&quot;intermediate&quot;</td><td>The intermediate directory where original image resources processed by MinerU are located.</td></tr></tbody></table><h2 id="xml-tag-protocol" tabindex="-1"><a class="header-anchor" href="#xml-tag-protocol"><span>XML Tag Protocol</span></a></h2><p>The operator expects the LLM to return data according to the following structure:</p><ul><li><code>&lt;chapter&gt;</code>: A chapter block containing a title and multiple QA pairs.</li><li><code>&lt;title&gt;</code>: The <strong>ID</strong> corresponding to the chapter title.</li><li><code>&lt;qa_pair&gt;</code>: A block representing a single question-answer pair.</li><li><code>&lt;question&gt;</code> / <code>&lt;solution&gt;</code>: A list of <strong>IDs</strong> (e.g., <code>1, 2, 5</code>) corresponding to the source content.</li><li><code>&lt;answer&gt;</code>: The answer extracted from the solution. <strong>This is actual text content, not an ID.</strong></li><li><code>&lt;label&gt;</code>: Question type or label information. <strong>This is a real sequence number/label, not an ID.</strong></li></ul><h2 id="run-function" tabindex="-1"><a class="header-anchor" href="#run-function"><span><code>run</code> Function</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">def</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">self</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        storage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> DataFlowStorage</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_response_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_converted_layout_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        input_name_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">        output_qalist_path_key</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;"> str</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">        )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Executes the parsing logic: Reads the LLM response, restores content using the layout JSON file, saves the result in JSONL format.</p><h4 id="parameters" tabindex="-1"><a class="header-anchor" href="#parameters"><span>Parameters</span></a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><strong>storage</strong></td><td>DataFlowStorage</td><td>Required</td><td>DataFlow storage instance.</td></tr><tr><td><strong>input_response_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the path to the original LLM response file.</td></tr><tr><td><strong>input_converted_layout_path_key</strong></td><td>str</td><td>Required</td><td>Column name for the path to the converted layout file (<code>_converted.json</code>).</td></tr><tr><td><strong>input_name_key</strong></td><td>str</td><td>Required</td><td>Column for the task name, which determines the naming of the output folder.</td></tr><tr><td><strong>output_qalist_path_key</strong></td><td>str</td><td>Required</td><td>Column name to store the path of the generated JSONL file.</td></tr></tbody></table><h2 id="ðŸ§ -example-logic" tabindex="-1"><a class="header-anchor" href="#ðŸ§ -example-logic"><span>ðŸ§  Example Logic</span></a></h2><h3 id="_1-id-restoration-process" tabindex="-1"><a class="header-anchor" href="#_1-id-restoration-process"><span>1. ID Restoration Process</span></a></h3><p>Suppose the LLM returns: <code>&lt;question&gt;1, 3&lt;/question&gt;</code> The operator looks up entries with <code>id</code> 1 and 3 in the layout JSON:</p><ul><li>If <code>id: 1</code> is the text &quot;What is AI?&quot; and <code>id: 3</code> is the image <code>path/to/img.png</code>.</li><li>The restored content will be: <code>What is AI?\\n![image](vqa_images/img.png)</code>.</li></ul><h3 id="_2-output-file-structure" tabindex="-1"><a class="header-anchor" href="#_2-output-file-structure"><span>2. Output File Structure</span></a></h3><p>After execution, the directory structure under <code>output_dir</code> (referenced as <code>cache_path</code> in some contexts) will be as follows:</p><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-text"><span class="line"><span>output_dir/</span></span>
<span class="line"><span>â””â”€â”€ {name}/</span></span>
<span class="line"><span>    â”œâ”€â”€ extracted_questions.jsonl  # Structured data</span></span>
<span class="line"><span>    â””â”€â”€ vqa_images/           # Automatically synchronized images</span></span>
<span class="line"><span>        â”œâ”€â”€ img1.png</span></span>
<span class="line"><span>        â””â”€â”€ ...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-jsonl-output-example" tabindex="-1"><a class="header-anchor" href="#_3-jsonl-output-example"><span>3. JSONL Output Example</span></a></h3><div class="language-json line-numbers-mode" data-highlighter="shiki" data-ext="json" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-json"><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">question</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Please analyze the image below:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">![image](vqa_images/img1.png)</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">answer</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">This is the parsed answer text.</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">solution</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Detailed step-by-step solution...</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">label</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">  &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">chapter_title</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Chapter 1: Fundamentals</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,25)]))}const d=i(n,[["render",l]]),p=JSON.parse('{"path":"/en/api/operators/pdf2vqa/generate/llmoutputparser/","title":"LLMOutputParser","lang":"en-US","frontmatter":{"title":"LLMOutputParser","createTime":"2026/01/20 20:15:00","permalink":"/en/api/operators/pdf2vqa/generate/llmoutputparser/"},"readingTime":{"minutes":1.58,"words":475},"git":{"createdTime":1769148661000,"updatedTime":1772028428000,"contributors":[{"name":"fatty-belly","username":"fatty-belly","email":"134311924+fatty-belly@users.noreply.github.com","commits":2,"avatar":"https://avatars.githubusercontent.com/fatty-belly?v=4","url":"https://github.com/fatty-belly"}]},"filePathRelative":"en/notes/api/operators/pdf2vqa/generate/LLMOutputParser.md","headers":[]}');export{d as comp,p as data};
